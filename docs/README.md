# Sistema de Gest√£o Escolar - Mergington High School

Sistema de gest√£o de atividades extracurriculares desenvolvido com Spring Boot e arquitetura limpa (Clean Architecture).

> **üìã √öltima Atualiza√ß√£o**: Esta documenta√ß√£o foi atualizada para refletir as funcionalidades mais recentes, incluindo categoriza√ß√£o autom√°tica de atividades, sistema de autentica√ß√£o aprimorado e novos endpoints.

## üìã Vis√£o Geral

O **School Management System** √© uma aplica√ß√£o web que permite o gerenciamento de atividades extracurriculares da Mergington High School. O sistema possibilita que professores administrem atividades e que estudantes se inscrevam nelas atrav√©s de uma interface web intuitiva.

## üèóÔ∏è Arquitetura

### Princ√≠pios Arquiteturais

- **Clean Architecture**: Separa√ß√£o clara entre camadas de dom√≠nio, aplica√ß√£o, infraestrutura e apresenta√ß√£o
- **Domain-Driven Design (DDD)**: Modelagem focada no dom√≠nio escolar
- **SOLID Principles**: C√≥digo bem estruturado e extens√≠vel
- **Hexagonal Architecture**: Isolamento das regras de neg√≥cio

### Estrutura de Camadas

```text
src/main/java/com/mergingtonhigh/schoolmanagement/
‚îú‚îÄ‚îÄ domain/                    # üéØ Camada de Dom√≠nio
‚îÇ   ‚îú‚îÄ‚îÄ entities/             # Entidades principais
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Activity.java     # Atividade extracurricular
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Teacher.java      # Professor/Administrador
‚îÇ   ‚îú‚îÄ‚îÄ repositories/         # Interfaces de reposit√≥rio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ActivityRepository.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TeacherRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ valueobjects/         # Objetos de valor
‚îÇ       ‚îú‚îÄ‚îÄ ActivityType.java       # ‚ú® Novo: Categoriza√ß√£o de atividades
‚îÇ       ‚îú‚îÄ‚îÄ Email.java        # Valida√ß√£o de email
‚îÇ       ‚îî‚îÄ‚îÄ ScheduleDetails.java # Detalhes de hor√°rio
‚îú‚îÄ‚îÄ application/              # üîß Camada de Aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ dtos/                 # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ActivityDTO.java
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ActivityTypeDTO.java    # ‚ú® Novo: Tipos de atividade
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginRequestDTO.java    # ‚ú® Novo: Request de login
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StudentRegistrationDTO.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TeacherDTO.java
‚îÇ   ‚îî‚îÄ‚îÄ usecases/             # Casos de uso
‚îÇ       ‚îú‚îÄ‚îÄ ActivityUseCase.java
‚îÇ       ‚îú‚îÄ‚îÄ AuthenticationUseCase.java  # ‚ú® Novo: Autentica√ß√£o
‚îÇ       ‚îî‚îÄ‚îÄ StudentRegistrationUseCase.java
‚îú‚îÄ‚îÄ infrastructure/           # üè≠ Camada de Infraestrutura
‚îÇ   ‚îú‚îÄ‚îÄ config/               # Configura√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ migrations/           # Migra√ß√µes do banco
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ V001_InitialDatabaseSetup.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ V002_AddMangaManiacsClub.java    # ‚ú® Novo: Clube Manga Maniacs
‚îÇ   ‚îî‚îÄ‚îÄ persistence/          # Implementa√ß√µes de reposit√≥rio
‚îÇ       ‚îú‚îÄ‚îÄ ActivityRepositoryImpl.java
‚îÇ       ‚îú‚îÄ‚îÄ MongoActivityRepository.java
‚îÇ       ‚îú‚îÄ‚îÄ MongoTeacherRepository.java
‚îÇ       ‚îî‚îÄ‚îÄ TeacherRepositoryImpl.java
‚îî‚îÄ‚îÄ presentation/             # üé® Camada de Apresenta√ß√£o
    ‚îú‚îÄ‚îÄ controllers/          # Controllers REST
    ‚îÇ   ‚îú‚îÄ‚îÄ ActivityController.java
    ‚îÇ   ‚îú‚îÄ‚îÄ AuthController.java     # ‚ú® Novo: Autentica√ß√£o
    ‚îÇ   ‚îî‚îÄ‚îÄ StaticController.java   # ‚ú® Novo: Conte√∫do est√°tico
    ‚îî‚îÄ‚îÄ mappers/              # Mapeadores DTO ‚Üî Entity
        ‚îú‚îÄ‚îÄ ActivityMapper.java
        ‚îî‚îÄ‚îÄ TeacherMapper.java
```

## üöÄ Tecnologias Utilizadas

### Backend

- **Java 21** - Linguagem de programa√ß√£o
- **Spring Boot 3.5.4** - Framework principal
- **Spring Data MongoDB** - Integra√ß√£o com MongoDB
- **Spring Security** - Autentica√ß√£o e autoriza√ß√£o
- **Spring Web** - APIs REST
- **Spring Validation** - Valida√ß√£o de dados
- **Mongock 5.5.1** - Migra√ß√µes do banco de dados
- **BouncyCastle** - Criptografia para senhas

### Frontend

- **HTML5/CSS3/JavaScript** - Interface web
- **Vanilla JavaScript** - Interatividade do frontend

### Banco de Dados

- **MongoDB** - Banco de dados NoSQL

### Ferramentas de Desenvolvimento

- **Maven** - Gerenciamento de depend√™ncias
- **JUnit 5** - Testes unit√°rios
- **Mockito** - Mocks para testes
- **Testcontainers** - Testes de integra√ß√£o
- **Jacoco** - Cobertura de testes

## üì¶ Funcionalidades Principais

### üéì Gest√£o de Atividades

- **Listagem de atividades** com filtros por:
  - Dia da semana
  - Hor√°rio (manh√£, tarde, fim de semana)
  - Categoria (esportes, artes, acad√™mico, etc.)
- **Detalhes de atividades**:
  - Nome e descri√ß√£o
  - Hor√°rios e dias da semana
  - Capacidade m√°xima
  - Lista de participantes
  - **‚ú® Tipo/Categoria da atividade** com cores visuais

### üè∑Ô∏è Categoriza√ß√£o de Atividades

O sistema agora categoriza automaticamente as atividades em 5 tipos principais:

- **üèÉ Esportes** (SPORTS): Atividades f√≠sicas, jogos em equipe, fitness
  - Cor: Verde claro (#e8f5e9) com texto verde escuro (#2e7d32)
  - Exemplos: Futebol, Basquete, Fitness

- **üé® Artes** (ARTS): Atividades criativas e culturais
  - Cor: Roxo claro (#f3e5f5) com texto roxo escuro (#7b1fa2)
  - Exemplos: Teatro, M√∫sica, Manga Maniacs

- **üìö Acad√™mico** (ACADEMIC): Atividades educacionais e competitivas
  - Cor: Azul claro (#e3f2fd) com texto azul escuro (#1565c0)
  - Exemplos: Olimp√≠ada de Matem√°tica, Clube de Ci√™ncias

- **ü§ù Comunidade** (COMMUNITY): Atividades de servi√ßo e voluntariado
  - Cor: Laranja claro (#fff3e0) com texto laranja escuro (#e65100)
  - Exemplos: Trabalho volunt√°rio, Projetos comunit√°rios

- **üíª Tecnologia** (TECHNOLOGY): Atividades relacionadas √† tecnologia
  - Cor: √çndigo claro (#e8eaf6) com texto √≠ndigo escuro (#3949ab)
  - Exemplos: Programa√ß√£o, Rob√≥tica, Computa√ß√£o

#### Categoriza√ß√£o Autom√°tica

O sistema possui um algoritmo inteligente que categoriza automaticamente as atividades baseado em palavras-chave do nome e descri√ß√£o:

- **Palavras-chave de Esportes**: futebol, basquete, esporte, fitness, equipe, time, jogo, atl√©tico
- **Palavras-chave de Artes**: arte, m√∫sica, teatro, drama, criativo, pintura, manga
- **Palavras-chave Acad√™micas**: ci√™ncia, matem√°tica, acad√™mico, estudo, olimp√≠ada, aprendizado, educa√ß√£o
- **Palavras-chave de Comunidade**: volunt√°rio, comunidade, servi√ßo
- **Palavras-chave de Tecnologia**: computador, programa√ß√£o, tecnologia, rob√≥tica, digital, rob√¥

> **Nota**: Se nenhuma palavra-chave for encontrada, a atividade √© categorizada como "Acad√™mico" por padr√£o.

### üë®‚Äçüè´ Sistema de Autentica√ß√£o

- **Login de professores** com username/senha via `/auth/login`
- **Verifica√ß√£o de sess√£o** via `/auth/check-session`
- **Controle de acesso** baseado em roles (TEACHER/ADMIN)
- **Autentica√ß√£o requerida** para inscri√ß√µes e cancelamentos
- **Criptografia Argon2** para senhas seguras

### üìù Gest√£o de Inscri√ß√µes

- **Inscri√ß√£o de estudantes** em atividades
- **Cancelamento de inscri√ß√µes**
- **Valida√ß√µes**:
  - Capacidade m√°xima
  - Duplicatas
  - Autentica√ß√£o do professor

### üé® Interface Web

- **Design responsivo** e intuitivo
- **Filtros din√¢micos** para busca de atividades
- **Modais** para login e inscri√ß√µes
- **Feedback visual** para a√ß√µes do usu√°rio

## üîß Configura√ß√£o e Execu√ß√£o

### Pr√©-requisitos

- Java 21
- Maven 3.8+
- MongoDB 4.4+

### Vari√°veis de Ambiente

Crie um arquivo `.env` baseado no `.env.example`

### Executando o Projeto

1. **Iniciar MongoDB**:

   ```bash
   # Docker
   docker run -d -p 27017:27017 --name mongodb mongo:latest
   
   # Ou MongoDB local
   mongod
   ```

2. **Compilar e executar**:

   ```bash
   # Compilar o projeto
   mvn clean compile
   
   # Executar os testes
   mvn test
   
   # Iniciar a aplica√ß√£o
   mvn spring-boot:run
   ```

3. **Acessar a aplica√ß√£o**:
   - Frontend: <http://localhost:8080>
   - API REST: <http://localhost:8080/activities>

### Tasks Maven Dispon√≠veis

- `mvn clean install` - Build completo
- `mvn test` - Executar testes
- `mvn spring-boot:run` - Iniciar aplica√ß√£o
- `mvn package -DskipTests` - Gerar JAR

## üåê API REST

### Endpoints Principais

#### Atividades

```http
GET /activities
GET /activities?day=Monday&start_time=15:00&end_time=17:00
GET /activities/days
```

#### ‚ú® Autentica√ß√£o

```http
# Login do professor
POST /auth/login
Content-Type: application/x-www-form-urlencoded

username=mrodriguez&password=art123

# Resposta de sucesso:
{
  "username": "mrodriguez",
  "name": "Sr. Rodriguez",
  "role": "TEACHER"
}

# Verificar sess√£o
GET /auth/check-session?username=mrodriguez

# Resposta de sucesso:
{
  "username": "mrodriguez", 
  "name": "Sr. Rodriguez",
  "role": "TEACHER"
}
```

#### Inscri√ß√µes

```http
# Inscrever estudante em atividade
POST /activities/{activityName}/signup
Content-Type: application/x-www-form-urlencoded

email=student@mergington.edu&teacher_username=mrodriguez

# Cancelar inscri√ß√£o
POST /activities/{activityName}/unregister
Content-Type: application/x-www-form-urlencoded

email=student@mergington.edu&teacher_username=mrodriguez
```

### Exemplo de Resposta - ‚ú® Estrutura Atualizada

#### GET /activities

```json
{
  "Chess Club": {
    "name": "Chess Club",
    "description": "Desenvolva estrat√©gia e pensamento cr√≠tico...",
    "schedule": "Mondays and Wednesdays, 15:30 - 17:00",
    "scheduleDetails": {
      "days": ["Monday", "Wednesday"],
      "startTime": "15:30",
      "endTime": "17:00"
    },
    "maxParticipants": 20,
    "participants": ["student1@mergington.edu"],
    "currentParticipantCount": 1,
    "type": {
      "name": "ACADEMIC",
      "label": "Acad√™mico",
      "color": "#e3f2fd",
      "textColor": "#1565c0"
    }
  },
  "Manga Maniacs": {
    "name": "Manga Maniacs",
    "description": "Mergulhe no incr√≠vel universo dos mang√°s japoneses!...",
    "schedule": "Ter√ßas-feiras, 19:00 - 20:00",
    "scheduleDetails": {
      "days": ["Tuesday"],
      "startTime": "19:00",
      "endTime": "20:00"
    },
    "maxParticipants": 15,
    "participants": [],
    "currentParticipantCount": 0,
    "type": {
      "name": "ARTS",
      "label": "Artes",
      "color": "#f3e5f5",
      "textColor": "#7b1fa2"
    }
  }
}
```

## üß™ Testes

### Estrutura de Testes

```text
src/test/java/
‚îú‚îÄ‚îÄ application/usecases/     # Testes de casos de uso
‚îú‚îÄ‚îÄ domain/entities/          # Testes de entidades
‚îî‚îÄ‚îÄ integration/             # Testes de integra√ß√£o
```

### Executar Testes

```bash
# Todos os testes
mvn test

# Testes espec√≠ficos
mvn test -Dtest=ActivityTest
mvn test -Dtest=StudentRegistrationUseCaseTest

# Com cobertura
mvn jacoco:report
```

## üìä Dados Iniciais

O sistema utiliza **Mongock** para realizar migra√ß√µes autom√°ticas do banco de dados, incluindo:

### Professores Padr√£o

- **mrodriguez** (Sr. Rodriguez) - Professor de artes, senha padr√£o: `art123`
- **mchen** (Sra. Chen) - Professora de xadrez, senha padr√£o: `chess123`  
- **principal** (Diretor Martinez) - Administrador principal, senha padr√£o: `admin123`

> **Nota**: As senhas podem ser configuradas via vari√°veis de ambiente: `TEACHER_RODRIGUEZ_PASSWORD`, `TEACHER_CHEN_PASSWORD`, `PRINCIPAL_PASSWORD`

### Atividades Exemplo

- **Art Club** - Ter√ßas e quintas, 15:30-17:00 (Tipo: ARTS)
- **Chess Club** - Segundas e quartas, 15:30-17:00 (Tipo: ACADEMIC)
- **Drama Club** - Quartas e sextas, 16:00-18:00 (Tipo: ARTS)
- **‚ú® Manga Maniacs** - Ter√ßas, 19:00-20:00 (Tipo: ARTS) - *Novo clube para explora√ß√£o da cultura manga japonesa*

## üîí Seguran√ßa

- **Autentica√ß√£o HTTP Basic** para endpoints administrativos
- **Criptografia Argon2** para senhas
- **Valida√ß√£o de dados** em todas as camadas
- **CORS** configurado para desenvolvimento

## üìà Monitoramento

- **Spring Actuator** - M√©tricas da aplica√ß√£o
- **Logs estruturados** - N√≠vel DEBUG para desenvolvimento
- **Health checks** - Status da aplica√ß√£o e banco

## üöÄ Deploy

### Perfis de Ambiente

- **dev** - Ambiente de desenvolvimento

## üìù Changelog

### ‚ú® Novas Funcionalidades Recentes

#### üè∑Ô∏è Sistema de Categoriza√ß√£o de Atividades
- **ActivityType Enum**: Categoriza√ß√£o autom√°tica em 5 tipos (SPORTS, ARTS, ACADEMIC, COMMUNITY, TECHNOLOGY)
- **Cores personalizadas** para cada tipo de atividade na interface
- **Algoritmo inteligente** de categoriza√ß√£o baseado em palavras-chave

#### üîê Sistema de Autentica√ß√£o Aprimorado  
- **Novos endpoints** `/auth/login` e `/auth/check-session`
- **DTOs dedicados** para requisi√ß√µes de login
- **Verifica√ß√£o de sess√£o** para valida√ß√£o de estado de autentica√ß√£o

#### üé≠ Nova Atividade: Manga Maniacs
- **Migra√ß√£o V002**: Adicionada atividade focada em cultura manga japonesa
- **Hor√°rio especializado**: Ter√ßas-feiras, 19:00-20:00
- **Categoria**: Artes com descri√ß√£o envolvente

#### üìä Estrutura de Resposta da API Atualizada
- **ActivityDTO aprimorado** com informa√ß√µes de tipo e cores
- **Dados mais ricos** para renderiza√ß√£o na interface
- **Compatibilidade mantida** com vers√µes anteriores
